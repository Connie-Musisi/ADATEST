% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Adjust2Median_function.R
\name{Adjust2Median}
\alias{Adjust2Median}
\title{Adjust Counts to Median Fold-Change Between Two Groups}
\usage{
Adjust2Median(data, group_var, group_levels)
}
\arguments{
\item{data}{A \code{phyloseq} object. It must contain an OTU table
accessible via \code{otu_table(data)} and sample metadata including a
\code{group} factor or numeric vector with values 0 and 1 (two groups).}
}
\value{
A \code{phyloseq} object with the same taxa and sample metadata,
but with the OTU counts for samples in \code{group == 0} multiplied by
the median fold-change factor.
}
\description{
This function scales the counts of samples in the reference group (group == 0)
so that the overall abundance shift between the two groups matches the median
log2-fold change observed across taxa. This adjustment can help mitigate
global compositional effects when comparing differential abundance.
}
\details{
The function works as follows:
\enumerate{
\item Transpose the OTU count matrix so that taxa become columns and samples rows.
\item Compute, for each taxon, the smallest non-zero count across all samples.
\item Calculate log2 fold-changes (LFC) between the two groups (1 vs. 0)
by adding the pseudocounts to avoid zeros:
\code{lfc = log2((mean(group==1) + min.nonzero) / (mean(group==0) + min.nonzero))}.
\item Compute the median of the back-transformed fold-changes: \code{med0 = 2^(median(lfc))}.
\item Multiply all counts in group 0 by \code{med0} to align the median abundance shift.
\item Reconstruct a new \code{phyloseq} object with adjusted OTU counts.
}
}
\examples{
\dontrun{
library(phyloseq)
# Assume `physeq` is a phyloseq object with sample_data containing `group` (0/1)
physeq_adj <- Adjust2Median(physeq)
# Inspect adjusted counts
otu_table(physeq_adj)
}

}
