% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/OrigAlz_function.R
\name{OrigAlz}
\alias{OrigAlz}
\title{Perform Permutation-Based Differential Abundance Testing}
\usage{
OrigAlz(data, Train_parest, B, p.adjust.method, group_var, group_levels)
}
\arguments{
\item{data}{A phyloseq object containing filtered microbiome data (after TSS and trimming).}

\item{Train_parest}{A numeric vector of parameter estimates from the training data, used to compute the test statistic.}

\item{B}{Integer. Number of permutations to perform.  Passed from \code{ADATEST()}.}

\item{p.adjust.method}{Character string specifying the p-value adjustment method. Passed from \code{ADATEST()}.}

\item{group_var}{Character. The name of the grouping variable in the sample metadata.  Passed from \code{ADATEST()}.}

\item{group_levels}{Character vector of length two, specifying the two levels of \code{group_var} to be compared. Passed from \code{ADATEST()}.}
}
\value{
A list containing:
\item{org_scaled}{Scaled OTU table from the original dataset (after normalization).}
\item{Org_tax}{Original taxonomy table as a data frame.}
\item{p}{Vector of unadjusted p-values for each taxon.}
\item{p.adjusted}{Vector of adjusted p-values based on the selected method.}
\item{Stat_Obs}{Vector of observed test statistics.}
\item{Original_results}{Data frame combining test statistics, taxonomic info, p-values, adjusted p-values, and differential abundance indicators.}
}
\description{
This function computes a test statistic for each taxon in a microbiome dataset using estimated scores.
It then performs a permutation test to assess statistical significance and adjusts p-values for false discovery rate (FDR) control.
}
\details{
The function computes the test statistic for each taxon based on estimated scores.
The total sum scaling (TSS)-normalized counts in the original dataset are rescaled before test statistic computation.
Permutation-based null distributions are generated by permuting all taxa across the two groups while preserving their dependency structure.
The resulting raw p-values are adjusted to control the false discovery rate (FDR) using methods such as Benjamini-Hochberg or Storey's q-values.
}
