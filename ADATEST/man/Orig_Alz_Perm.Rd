% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/OrigAlz_function.R
\name{Orig_Alz_Perm}
\alias{Orig_Alz_Perm}
\title{Perform Permutation-Based Differential Abundance Testing}
\usage{
Orig_Alz_Perm(
  simdata_filter,
  Train_parest,
  B = 1000,
  p.adjust.method = "BH",
  n1 = nrow(org_otu)/2,
  n2 = nrow(org_otu)/2
)
}
\arguments{
\item{simdata_filter}{A phyloseq object containing filtered microbiome data.}

\item{Train_parest}{Training parameters for test statistic computation.}

\item{B}{Integer. Number of permutations to perform (default: 1000).}

\item{p.adjust.method}{Character. Method for p-value adjustment (default: "BH").}

\item{n1}{Integer. Number of samples in group 0 (default: computed from dataset).}

\item{n2}{Integer. Number of samples in group 1 (default: computed from dataset).}
}
\value{
A list containing:
\item{org_otu}{Original OTU table as a matrix.}
\item{Org_tax}{Original taxonomy table as a data frame.}
\item{p}{Vector of unadjusted p-values.}
\item{p.adjusted}{Vector of adjusted p-values.}
\item{Stat_Obs}{Observed test statistics.}
\item{Original_results}{Data frame containing test results, including p-values and adjusted indicators.}
}
\description{
This function computes a test statistic for each taxon in a microbiome dataset using estimated scores.
It then performs a permutation test to assess statistical significance and adjusts p-values for false discovery rate (FDR) control.
}
\details{
The function computes the test statistic for each taxon based on estimated scores.
The total sum scaling (TSS)-normalized counts in the original dataset are rescaled before test statistic computation.
Permutation-based null distributions are generated by permuting all taxa across the two groups while preserving their dependency structure.
The resulting raw p-values are adjusted to control the false discovery rate (FDR) using methods such as Benjamini-Hochberg or Storey's q-values.
}
